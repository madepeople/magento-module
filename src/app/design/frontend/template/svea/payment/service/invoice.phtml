<?php
/**
 * WARNING! Do not change the classes on the containers and fields as these
 * are referenced by the JavaScript file used to determine which fields to
 * display, when to do getAddress and so on.
 *
 * @author jonathan@madepeople.se
 */
?>
<?php $_typeIndividual = Svea_WebPay_Helper_Data::TYPE_INDIVIDUAL ?>
<?php $_typeCompany = Svea_WebPay_Helper_Data::TYPE_COMPANY ?>
<?php $_quote = $this->getMethod()->getInfoInstance()->getQuote() ?>
<div id="payment_form_<?php echo $this->getMethodCode() ?>" style="display:none;">
    <div id="svea-invoice-payment-information" class="svea-payment-se svea-payment-dk svea-payment-no svea-payment-fi svea-payment-nl svea-payment-de">
        <!-- Shared by all countries and types -->
        <ul class="form-list">
            <?php $_checkoutInfo = trim(Mage::getStoreConfig('payment/' . $this->getMethodCode() . '/invoice_info')); ?>
            <?php if (!empty($_checkoutInfo)): ?>
                <li>
                    <?php echo nl2br($_checkoutInfo) ?>
                </li>
            <?php endif ?>
            <li class="control">
                <input type="radio" name="payment[<?php echo $this->getMethodCode() ?>][customer_type]" value="<?php echo $_typeIndividual ?>"<?php if ($this->getAdditionalData('customer_type') === $_typeIndividual || $this->getAdditionalData('customer_type') == '') echo ' checked="checked"' ?> id="payment_customer_type_<?php echo $_typeIndividual ?>"><label for="payment_customer_type_<?php echo $_typeIndividual ?>"> <?php echo $this->__($_typeIndividual) ?></label>
            </li>
            <li class="control">
                <input type="radio" name="payment[<?php echo $this->getMethodCode() ?>][customer_type]" value="<?php echo $_typeCompany ?>"<?php if ($this->getAdditionalData('customer_type') === $_typeCompany) echo ' checked="checked"' ?> id="payment_customer_type_<?php echo $_typeCompany ?>"><label for="payment_customer_type_<?php echo $_typeCompany ?>"> <?php echo $this->__($_typeCompany) ?></label>
            </li>
        </ul>

        <!-- For private individuals -->
        <div class="svea-type-<?php echo $_typeIndividual ?>">
            <!-- Scandinavia -->
            <ul class="form-list svea-payment-se svea-payment-dk svea-payment-no svea-payment-fi">
                <li class="fields">
                    <div class="field input-box">
                        <label for="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_ssn" class="required"><em>*</em><?php echo $this->__('text_ssn') ?></label>
                        <div class="input-box">
                            <input type="text" class="input-text required-entry" value="<?php echo $this->getAdditionalData('ssn_vat', $_typeIndividual) ?>" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][ssn_vat]" id="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_ssn">
                        </div>
                    </div>
                </li>
            </ul>

            <!-- Germany and the Netherlands -->
            <ul class="form-list svea-payment-nl svea-payment-de">
                <li class="fields">
                    <div class="field">
                        <div class="field">
                            <label for="billing:month"><?php echo $this->__('text_date_of_birth') ?></label>
                            <div class="input-box customer-dob">
                                <div class="dob-year">
                                    <input type="text" id="payment:year" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][birth_year]" value="" title="Year" class="input-text validate-custom" autocomplete="off">
                                    <label for="payment:year" class="required"><em>*</em><?php echo $this->__('YYYY') ?></label>
                                </div><div class="dob-month">
                                    <input type="text" id="payment:month" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][birth_month]" value="" title="Month" class="input-text validate-custom">
                                    <label for="payment:month" class="required"><em>*</em><?php echo $this->__('MM') ?></label>
                                </div><div class="dob-day">
                                    <input type="text" id="payment:day" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][birth_day]" value="" title="Day" class="input-text validate-custom">
                                    <label for="payment:day" class="required"><em>*</em><?php echo $this->__('DD') ?></label>
                                </div>
                                <div class="dob-full" style="display:none;">
                                    <input type="hidden" id="payment:dob" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][dob]">
                                </div>

                                <div class="validation-advice" style="display: none;"></div>
                            </div>
                            <script type="text/javascript">
                                //<![CDATA[
                                var customer_dob = new Varien.DOB('.customer-dob', true, '%Y-%m-%d');
                                //]]>
                            </script>
                        </div>
                    </div>
                </li>
            </ul>

            <!-- Initials and house number for the Netherlands + Germany -->
            <ul class="form-list svea-payment-nl svea-payment-de">
                <li class="fields">
                    <div class="field">
                        <label for="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_housenumber" class="required"><em>*</em><?php echo $this->__('text_housenumber') ?></label>
                        <div class="input-box">
                            <input type="text" class="input-text required-entry" id="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_housenumber" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][housenumber]" />
                        </div>
                    </div>
                    <div class="field svea-payment-nl">
                        <label for="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_initials" class="required"><em>*</em><?php echo $this->__('text_initials') ?></label>
                        <div class="input-box">
                            <input type="text" class="input-text required-entry" id="payment_<?php echo $_typeIndividual ?>_<?php echo $this->getMethodCode() ?>_initials" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeIndividual ?>][initials]" />
                        </div>
                    </div>
                </li>
            </ul>

            <!-- Only Sweden and Denmark use the get address function -->
            <ul class="form-list svea-payment-se svea-payment-dk svea-get-address">
                <li class="control">
                    <button type="button" class="button" onclick="window.svea.getAddress('<?php echo $this->getMethodCode() ?>')">
                        <span>
                            <span><?php echo $this->__('get_address') ?></span>
                        </span>
                    </button>
                </li>
            </ul>
        </div>

        <!-- For companies -->
        <div class="svea-type-<?php echo $_typeCompany ?>">
            <!-- Scandinavia -->
            <ul class="form-list svea-payment-se svea-payment-dk svea-payment-no svea-payment-fi svea-payment-nl svea-payment-de">
                <li class="fields">
                    <div class="field input-box">
                        <label for="payment_<?php echo $_typeCompany ?>_<?php echo $this->getMethodCode() ?>_ssn" class="required"><em>*</em><?php echo $this->__('text_vat_no') ?></label>
                        <div class="input-box">
                            <input type="text" class="input-text required-entry" value="<?php echo $this->getAdditionalData('ssn_vat', $_typeCompany) ?>" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeCompany ?>][ssn_vat]" id="payment_<?php echo $_typeCompany ?>_<?php echo $this->getMethodCode() ?>_ssn">
                        </div>
                    </div>
                </li>
            </ul>

            <!-- Initials and house number for the Netherlands + Germany -->
            <ul class="form-list svea-payment-nl svea-payment-de">
                <li class="fields">
                    <div class="field">
                        <label for="payment_<?php echo $_typeCompany ?>_<?php echo $this->getMethodCode() ?>_housenumber" class="required"><em>*</em><?php echo $this->__('text_housenumber') ?></label>
                        <div class="input-box">
                            <input type="text" class="input-text required-entry" id="payment_<?php echo $_typeCompany ?>_<?php echo $this->getMethodCode() ?>_housenumber" name="payment[<?php echo $this->getMethodCode() ?>][<?php echo $_typeCompany ?>][housenumber]" />
                        </div>
                    </div>
                </li>
            </ul>

            <!-- Only Sweden and Denmark use the getAddress function -->
            <ul class="form-list svea-payment-se svea-payment-dk svea-get-address">
                <li class="control">
                    <button type="button" class="button" onclick="window.svea.getAddress('<?php echo $this->getMethodCode() ?>')">
                        <span>
                            <span><?php echo $this->__('get_address') ?></span>
                        </span>
                    </button>
                </li>
            </ul>
        </div>

        <!-- We put the getAddressed address inside this little boxy box -->
        <div class="svea-payment-se svea-payment-dk">
            <div id="svea-invoice-address-box" class="svea-address-box tool-tip" style="position:static;margin-bottom:10px;display:none;">
                <img class="svea-loader" src="<?php echo $this->getSkinUrl('svea/loader-blue.gif') ?>">
                <div class="svea-address-container" style="display:none">
                    <strong style="display: block;border-bottom: 1px solid #A2B5C4;margin-bottom: 10px;"><?php echo $this->__('your_invoice_will_be_sent_to') ?></strong>
                    <div class="svea-select-container"></div>
                    <address class="svea-address-element" style="font-size:14px; font-weight: bold;"></address>
                </div>
            </div>

            <!-- Using a div tag for a template actually works everywhere, it
                 would be more nice to use a script tag, but prototype is weird -->
            <div id="svea-invoice-address-template" style="display:none">
                <?php echo $this->getMethod()->getConfigData('address_template') ?>
            </div>
        </div>
    </div>
</div>
